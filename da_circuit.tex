\documentclass{standalone}
\usepackage{tikz}
\usepackage{circuitikz}
\usetikzlibrary{calc,backgrounds}

% Use layers so atom orbits can always sit behind the wiring.
\pgfdeclarelayer{background}
\pgfsetlayers{background,main}

\begin{document}
\begin{tikzpicture}
    % -----------------------------
    % Parameters (tweak as needed)
    % -----------------------------
    \def\R{.6 * 1.00}        % nucleus radius (cm)
    \def\ra{.6 * 2.70/2}     % orbit ellipse x-radius (cm)  = a
    \def\rb{.6 * 1.55/2}     % orbit ellipse y-radius (cm)  = b
    \def\lw{0.8pt}           % line width (uniform)
    \def\wireLen{2.3}        % length of the downward wire (cm) (unused but kept)

    % Orbit rotation angles (degrees)
    \def\phiA{0}
    \def\phiB{60}
    \def\phiC{-60}

    % Label font for the nucleus text — adjust to taste
    \newcommand{\labelfont}{\sffamily\bfseries\fontsize{16pt}{16pt}\selectfont}
    % Try 18–28pt depending on how full you want the A to look relative to R=1cm.

    %-----------------------------
    % Styles and helpers
    % -----------------------------
    \tikzset{schem/.style={draw=black, line width=\lw, line cap=round, line join=round}}

    % Compute crossing angle θ× (degrees) for ellipse-circle intersection:
    % a^2 cos^2 t + b^2 sin^2 t = R^2  =>  cos^2 t = (R^2 - b^2)/(a^2 - b^2)
    % Clamp to [0,1] to avoid NaN if parameters are borderline.
    \pgfmathsetmacro{\coscrit}{(\R*\R - \rb*\rb)/(\ra*\ra - \rb*\rb)}
    \pgfmathsetmacro{\coscrit}{max(0,min(1,\coscrit))}
    \pgfmathsetmacro{\tCross}{acos(sqrt(\coscrit))}   % in degrees
    \pgfmathsetmacro{\tUpperStart}{\tCross}
    \pgfmathsetmacro{\tUpperEnd}{180 - \tCross}
    \pgfmathsetmacro{\tLowerStart}{-180 + \tCross}
    \pgfmathsetmacro{\tLowerEnd}{-\tCross}

    % Draw the single front arc (upper half inside the circle) for an ellipse rotated by φ
    % #1 = rotation angle, #2 = center coordinate (e.g. (D), (A))
    \newcommand{\frontarcUpper}[2]{%
      \begin{scope}[shift={#2},rotate=#1]
        \draw[schem] ({\ra*cos(\tUpperStart)},{\rb*sin(\tUpperStart)})
          arc[x radius=\ra, y radius=\rb,
              start angle=\tUpperStart, end angle=\tUpperEnd];
      \end{scope}
    }

    % Alternate: lower half inside the circle
    \newcommand{\frontarcLower}[2]{%
      \begin{scope}[shift={#2},rotate=#1]
        \draw[schem] ({\ra*cos(\tLowerStart)},{\rb*sin(\tLowerStart)})
          arc[x radius=\ra, y radius=\rb,
              start angle=\tLowerStart, end angle=\tLowerEnd];
      \end{scope}
    }

    % -----------------------------
    % Reusable atom macro
    % -----------------------------
    % #1 = center coordinate name (e.g. D), #2 = label text (e.g. D)
    \newcommand{\atom}[2]{%
      % Full orbits (behind the nucleus)
      \begin{pgfonlayer}{background}
        \draw[schem] (#1) ellipse [x radius=\ra, y radius=\rb, rotate=\phiA];
        \draw[schem] (#1) ellipse [x radius=\ra, y radius=\rb, rotate=\phiB];
        \draw[schem] (#1) ellipse [x radius=\ra, y radius=\rb, rotate=\phiC];
      \end{pgfonlayer}
      % White disk to hide crossings (puts the mid-portion "behind")
      \fill[white] (#1) circle[radius=\R];
      % Place the visible label
      \node at (#1) {\labelfont #2};
      % One *front* arc per orbit (same choices as original)
      \frontarcLower{\phiA}{(#1)}%
      \frontarcUpper{\phiB}{(#1)}%
      \frontarcUpper{\phiC}{(#1)}%
      % Nucleus outline LAST to cover any seam
      \draw[schem] (#1) circle[radius=\R];
    }

    % -----------------------------
    % Circuit + atom placement
    % -----------------------------
    % Define variables for better adjustability
    \def\atomSep{3}         % Separation between atoms (horizontal distance)
    \def\rowSep{1.5}        % Base vertical spacing unit
    \def\batteryWidth{2}    % Width of the battery

    % Atom centers used for the circuit wiring
    \coordinate (D) at (0,0);
    \coordinate (A) at (\atomSep,0);

    % Battery placement
    \coordinate (BatLeft) at  (\atomSep/2 - \batteryWidth/2, -\rowSep);
    \coordinate (BatRight) at (\atomSep/2 + \batteryWidth/2, -\rowSep);

    % Draw the battery
    \draw[thick] (BatLeft) to[battery1, name=Bat] (BatRight);

    % Add + and - labels above battery terminals
    \node[above] at (BatLeft)  {$+$};
    \node[above] at (BatRight) {$-$};

    % Connect atoms to battery terminals
    \draw[thick] (D) |- (BatLeft);
    \draw[thick] (A) |- (BatRight);

    % -----------------------------
    % Draw both atoms using the reusable macro
    % -----------------------------
    \atom{D}{D}
    \atom{A}{A}

\end{tikzpicture}
\end{document}
