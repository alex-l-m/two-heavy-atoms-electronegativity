## Introduction

<!-- 1. Identify the problem: what to include in a dataset? / We can include electronegativity in datasets -->
Atomistic simulation has long involved a trade-off: *ab initio* methods are accurate but computationally expensive, while force fields sacrifice accuracy for speed.
Over the past decade, machine learning interatomic potentials (MLIPs) have aimed to approach _ab initio_ accuracy with force-field efficiency, but training them requires large datasets generated from *ab initio* calculations [@MILPReview2025].
In the past few years, datasets of the scale required for machine learning have been released for both molecules [@comp6,@isayevani2,@omol25] and crystal structures [@chgnet,@omat24].

A trend in the development of these datasets has been the inclusion of increasingly distorted geometries.
Although conformer generation has long been standard practice in computational organic chemistry, early machine learning datasets included only equilibrium geometries [@qm9,@tmqm].
More recent datasets have included conformers and MD trajectories [@comp6,@omol25], and crystal datasets have followed a similar progression: starting with equilibrium geometries [@matproj], then adding relaxation trajectories [@chgnet,@oc20], and now using Boltzmann sampling and molecular dynamics [@omat24].
In these off-equilibrium geometries, atoms are annotated with forces, and including forces in MLIP training results in lower test errors than training on energies only [@pinheiro2021].

Besides force, another atomic property included in some datasets [@comp6,@omol25] is partial charge.
Partial charges are used to compute the electrostatic component of energy in some traditional force fields [@polarizableFFReviewJing] and MLIPs [@Anstine2023].
In traditional polarizable force fields, charge is typically predicted using charge equilibration (QEq) [@rappe1991charge], a family of related empirical models based on solving a linear system.
QEq has also become a component of "fourth-generation" MLIPs [@fourGenerations], with the innovation of environment-dependent QEq parameters.

Although QEq models can be trained using system-level observables such as dipole moments [@chemicalPotentialEqualization], the availability of per-atom charge annotations enables a more direct strategy: training the model by minimizing errors in the predicted charges themselves [@verstraelenElectronegativityParameters].
Interestingly, QEq has sometimes been trained on data including systems subjected to external perturbations, such as the electrostatic potential created by a nearby point charge, to probe how charges respond [@verstraelenElectronegativityParameters; @verstraelenSilicatesResponse].

ML-scale training datasets do not currently include this kind of externally perturbed system.
Using external potentials to augment ML training datasets with distorted electron densities could help models generalize to chemical environments not directly present in the training data, or help with QM/MM applications [@polarizableQMMM].

<!-- 2. Conceptual DFT / Electronegativity is a real thing -->
The possibility we will explore in this work is not just distorting electron densities via external potentials, but annotating the data with a new atomic property, associated with distorted densities just as force is associated with distorted geometries.
This property is electronegativity, as defined in conceptual density functional theory (DFT) [@geerlingsconceptualDFTreview].

Conceptual DFT began with a new definition of the electronegativity of a system: the negative of the chemical potential of the electrons [@parrcdftelectronegativity].
Defined this way, the electronegativity $\chi(q)$ is an increasing function of charge $q$, and can be associated with any system, not just a neutral atom but also an ion, a molecule, or a material.
For example, the fluorine atom is very electronegative (high $\chi(0)$), but the fluoride anion less so (smaller $\chi(-1)$).
This charge-dependent concept departs from the traditional concept in which electronegativity is a property of an element, but recovers the familiar Mulliken electronegativity from $\chi(0)$ of a neutral atom.

Defining not only the electronegativity $\chi$ of a system, but also the electronegativity $\chi_k$ of an atom $k$ within the system, provides the foundation for charge prediction with QEq [@conceptualDFTElectronegativityOriginal].
QEq methods predict atomic charges $\vect{q}$ by electronegativity equalization: solving $\chi_k(\vect{q})=\chi$ under a constraint on total charge.
For example, a neutral chlorine atom is more electronegative than a neutral hydrogen atom, but after combining to form hydrogen chloride, the negative chlorine and the positive hydrogen have equal electronegativities.

<!-- Analogy to force -->
The electronegativity equalization condition is analogous to the condition that equilibrium geometries have zero force, since like force, $\chi_k$ is a derivative of energy.
This seems to imply that electronegativity is not an interesting atomic property, since at equilibrium all $\chi_k$ are equal.
However, as we will explain, systems with an external potential imposed can be regarded as having non-equalized electronegativities.
From this perspective, such systems have off-equilibrium electron densities, analogous to the off-equilibrium geometries which have already proven useful in MLIP training data.

<!-- 5. q-prediction and partial charge / We currently only do q-prediction, but... -->
<!-- 6. χ-prediction / We should be doing χ-prediction instead -->
Like force, atomic electronegativity $\chi_k$ can be used as a prediction target when training models.
To demonstrate this, we train a QEq model on a dataset of binary materials, determining its parameters by minimizing the error in predicting $\chi_k$.
Although QEq has a natural framing as a linear model for this $\chi$-prediction task, our study is the first to train a QEq model on electronegativities, rather than charges, extracted from DFT.
After training, we use the resulting model for charge prediction (the $q$-prediction task) by equalizing electronegativity.
