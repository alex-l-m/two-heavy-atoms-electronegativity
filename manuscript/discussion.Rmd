# Discussion

We have, for the first time, trained a QEq model by minimizing error in the $\chi$-prediction task.
To train in the $\chi$-prediction task, we created a dataset of binary materials annotated with $\Delta \chi$ by imposing an external electric field.
Using a relationship with the strength of the electric field, we computed $\Delta \chi$ for each frame.
Then, we trained a QEq model using least squares linear regression using the atomic partial charge $q_A$ to define the independent variables, and using $\Delta \chi$ as the dependent variable, with the $\chi^0_e$ and $\eta_e$ parameters of the QEq model estimated as regression coefficients.
Since classical QEq is one of the simplest empirical models of charge, it is satisfying that in the $\chi$-prediction problem it corresponds to training a linear model, the most basic model in machine learning.
Once the QEq model was trained in the $\chi$-prediction task, we used it for the $q$-prediction task.

An intuitive picture of the meaning of our calculation of $\Delta \chi$ is provided by considering the final frame in each series, in which the charges of both atoms are zero.
The atoms are being held in the neutral state by the electric field.
The electronegativity difference $\Delta \chi^0$ is being measured by the strength of the field required to prevent charge transfer.

In the course of our demonstration of training with $\chi$-prediction, three main technical challenges emerged, but were ultimately solvable.
Perhaps the most important is that the shape of the field has to be matched to the shape of the weight functions used to define the partial charge.
Another complication is that the relationship between $\chi_k$ and the imposed electrical potential $\lambda_k$ involves the system electronegativity $\chi$.
For the binary systems, we handled this by taking the difference $\Delta \chi$, which subtracts off $\chi$.
This solution does not work in the $n$-atom case, but in our Supplementary Theory section we showed that $\chi$ can be included as an additional variable in the linear regression.
Since we used Hirshfeld-I atoms, where the weight functions depend on the charge itself, there was an additional complication, adjusting for the change in boundaries between the atoms.
We computed this correction from individual frames using an analytic derivative of the weight function.
This would be more complicated using more flexible partial charge definitions like Bader charges [@baderbook] or MBIS [@mbis], which would require analytic derivatives of the density with respect to the field.

## Conclusions

We have demonstrated a new approach by annotating our training dataset with first-principles atomic electronegativities, and training a charge prediction model in the $\chi$-prediction problem.
This indirect method of charge prediction is analogous to the prediction of equilibrium geometries using a model trained to determine forces.
Our simple demonstration opens a new direction in training charge models, in which the model learns a generalized force on a charge.

The current generation of machine learning datasets includes atomic $q_k$, as well as off-equilibrium geometries and forces [@isayevani2,@omol25].
Charge models would benefit if the next generation includes, not only off-equilibrium electron densities obtained by applying a field, but electronegativities $\chi_k$, analogous to the forces included for the off-equilibrium geometries.
Most directly, such a dataset could then be used as a training target for the QEq models used in force fields and machine learning interatomic potentials.
However, with our perspective that $\chi$-prediction from partial charges is a crude approximation to the exact map from densities to potentials, such datasets may be useful even for model architectures that do not learn charges.
