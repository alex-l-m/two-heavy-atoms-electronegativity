# Discussion

We have, for the first time, trained a charge prediction model by minimizing error in the $\chi$-prediction task.
We created a training dataset of binary materials, and for each material, sampled a continuum of charge states ("frames") by imposing an external potential.
We computed $\Delta \chi$ for each frame, using a relationship with the strength of the imposed potential.
Then, we trained a QEq model using least squares linear regression.
Framed as linear regression, the atomic partial charges defined the independent variables, and $\Delta \chi$ was the dependent variable.
Once the QEq model was trained in this $\chi$-prediction task, we used it for the $q$-prediction task by equalizing electronegativity.
Since classical QEq is one of the simplest empirical models of charge, it is satisfying that in the $\chi$-prediction problem it corresponds to training a linear model, the most basic model in machine learning.

An intuitive picture of the meaning of our calculation of $\Delta \chi$ is provided by considering the final frame in each series, in which the charges of both atoms are zero.
The atoms are being held in the neutral state by the electric field.
The electronegativity difference $\Delta \chi^0$ is being measured by the strength of the field required to prevent charge transfer.

In the course of our demonstration of training with $\chi$-prediction, three main technical challenges emerged, but were ultimately solvable.
The most important is that the shape of the field has to be matched to the shape of the weight functions used to define the partial charge.
Another complication is that the relationship between $\chi_k$ and the imposed electrical potential $\lambda_k$ involves the system electronegativity $\chi$.
For the binary systems, we handled this by taking the difference $\Delta \chi$, which subtracts off $\chi$, and derived a more general solution for the $n$-atom case.
There was an additional complication because we used a variant of Hirshfeld-I charges, in which the boundary between atoms depends on their charges.
This was solved by computing a correction for the boundary response, which to our knowledge has not yet appeared in the literature.
In our case the correction could be easily computed with an integral against the density, but it would be more difficult to compute for more flexible partial charge definitions like Bader charges [@baderbook] or MBIS [@mbis].

## Conclusions

We have demonstrated a new approach by annotating our training dataset with first-principles atomic electronegativities, and training a charge prediction model in the $\chi$-prediction problem.
This indirect method of charge prediction is analogous to the prediction of equilibrium geometries using a model trained to determine forces.
Our simple demonstration opens a new direction in training charge models, in which the model learns a generalized force on a charge.

The current generation of machine learning datasets includes atomic $q_k$, as well as off-equilibrium geometries and forces [@isayevani2,@omol25].
Charge models would benefit if the next generation includes, not only off-equilibrium electron densities obtained by applying a field, but electronegativities $\chi_k$, analogous to the forces included for the off-equilibrium geometries.
Most directly, such a dataset could then be used as a training target for the QEq models used in force fields and machine learning interatomic potentials.
However, with our perspective that $\chi$-prediction from partial charges is a crude approximation to the exact map from densities to potentials, such datasets may be useful even for model architectures that do not learn charges.
